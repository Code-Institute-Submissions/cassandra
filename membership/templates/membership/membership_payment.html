{% extends "base.html" %}
{% load static %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col-12 col-md-7">
            <h2 class="logo-font fw700">{{ heading }}</h2>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}

<link rel="stylesheet" type="text/css" href="{% static 'css/checkout.css' %}">


<div class="container">
    <div class="row">
        <h1>Payment</h1>
        <div class="col-sm-4 col-md-4">
            <p>Selected membership: {{ selected_membership }}</p>
            <p>Price: <strong>${{ selected_membership.price }}</strong><small>/month</small></p>


            <button onclick="toggleDisplay();" class="btn btn-warning" style="width: 100%;">Checkout with a credit card</button>


            <div id="collapseStripe" class="wrapper">
                <script src="https://js.stripe.com/v3/"></script>

                <!-- can't do this -->
                <!-- <script src="{% static 'js/stripeV3.js' %}"></script> -->

                <form action="." method="post" id="payment-form">
                    {% csrf_token %}
                    <div class="form-row">
                        <label for="card-element">
                            Credit or debit card
                        </label>
                        <div id="card-element" class="StripeElement StripeElement--empty">

                        </div>

                        <!-- Used to display form errors. -->
                        <div id="card-errors" role="alert"></div>
                    </div>

                    <button>Submit Payment</button>
                </form>


            </div>

        </div>

        <div id="stripe-token-handler" class="is-hidden">Success! Got token: <span class="token"></span></div>


    </div>
</div>
</div>


<!-- script for the stripe form -->




<!-- script for toggling display of the form -->



{% endblock content %}

{% block postloadjs %}
{{ block.super }}
{{ stripe_public_key|json_script:"id_stripe_public_key" }}
{{ client_secret|json_script:"id_client_secret" }}
<script src="{% static 'js/checkout.js' %}"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script type="text/javascript">
    function toggleDisplay() {
        var x = document.getElementById("collapseStripe");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    };
</script>
{% endblock %}